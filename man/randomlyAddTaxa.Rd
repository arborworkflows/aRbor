% Generated by roxygen2 (4.0.1): do not edit by hand
\name{randomlyAddTaxa}
\alias{randomlyAddTaxa}
\title{Add species into phylogeny near hypothesized relatives}
\usage{
randomlyAddTaxa(tree, groupings, fromNode, noRandomTrees,
  printToScreen = TRUE, saveToFile = FALSE)
}
\arguments{
\item{tree}{An ape-style phylogenetic tree}

\item{groupings}{A data frame with two columns, "species" and "group". Missing species,
to be added, are taken as those that do not match a value in the tip labels of tree.}

\item{fromNode}{Whether species should be added in a "polytomy" with, "crown" (more recently
diverged), "stem" (previously diverged), or "randomly" crown-wards or stem-wards from
the tip they are bound to.}

\item{noRandomTrees}{The number of desired final trees with all missing species from
groupings added.}

\item{printToScreen}{Default is TRUE. Will print a list of the missing taxa to screen.}

\item{saveToFile}{Default is FALSE. To automatically save multiPhylo object to file,
set to TRUE. The object will not be stored directly in memory, but it is calculated in
memory. The function could probably be sped up by having this save directly to file,
appending each tree instead of first saving them all to memory.}
}
\value{
A multiPhylo object with number of trees as determined by noRandomTrees
}
\description{
Given a data frame of species and taxonomic assignments, and an accepted phylogeny with
some of those species in it, will add the missing species in next to a taxonomic
relative.
}
\details{
Given a data frame of two columns, "species" and "group", will take a species
that is absent from the phylogeny and bind it to a randomly selected taxonomic
relative. Note that the current implementation of the function iteratively builds up
the tree, meaning that a species being bound into the tree can be bound to a
species that was in the input phylogeny, or to a species that was added during a
previous iteration of the function. Previously, added species could only be bound to
species that were in the input phylogeny. This new feature slows the function down,
but it results in more realistic-looking, less ladderized trees. Four distinct methods
of adding new taxa are possible. With "polytomy", the new species is simply assigned to
a tip. Both species end up with branch lengths to their most recent common ancestor of
0. With "crown", the new species is bound in at half the distance between the species
it is being bound to and that species' original parent node. With "stem", the new
species is bound to the parent node of the species it was selected to be bound to. The
new species is bound in at half the distance between the parent node and grandparent
node. With "randomly", each new species is randomly bound either crown-wards or
stem-wards, following the descriptions above. Note that even if "stem" or "randomly"
are chosen, if a species is to be bound to the sister species to all others (the most
"basal" species in the phylogeny), it will automatically be bound stem-wards. With all
options, if the input tree is ultrametric, the output trees should remain so.
Currently, no effort is made to ensure that the taxonomic groups of the missing species
are actually to be found in the species in the input tree.
}
\examples{
#start libraries
library(phytools)

#load a molecular tree up
data(bird.families)

#create a data frame of all taxa from the phylogeny, and make up species groups
for each.
dummy.frame <- data.frame(species=bird.families$tip.label,
group=c(rep("nonPasserine", 95), rep("suboscine", 9), rep("basalOscine", 13),
rep("oscine", 20)))

#now make up a few passerine taxa that are missing and add these into the dummy frame
toAdd <- data.frame(species=c("Icteria", "Yuhina", "Pityriasis", "Macgregoria"),
group=c(rep("oscine", 2), rep("basalOscine", 2)))
groupsDF <- rbind(dummy.frame, toAdd)

#examples of changing the fromNode argument. you can plot or write these trees out to
#better see what the differences are
crown <- randomlyAddTaxa(tree=bird.families, groupings=groupsDF, fromNode="crown", noRandomTrees=10)
stem <- randomlyAddTaxa(tree=bird.families, groupings=groupsDF, fromNode="stem", noRandomTrees=10)
polytomy <- randomlyAddTaxa(tree=bird.families, groupings=groupsDF, fromNode="polytomy", noRandomTrees=10)
}
\references{
Eliot Miller unpublished
}

